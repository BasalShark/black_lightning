<% @title = 'Show Details' %>

<h1><%= @show.name %></h1>
<table class="table table-bordered">
	<tbody>
		<tr>
			<th>Tagline</th>
			<td><%= @show.tagline %></td>
		</tr>
		<tr>
			<th>URL Slug</th>
			<td><%= @show.slug %></td>
		</tr>
		<tr>
			<th>Description</th>
			<td><%= render_markdown @show.description %></td>
		</tr>
        <tr>
            <th>Dates</th>
            <td><%= @show.date_range %></td>
        </tr>
        <tr>
            <th>Venue</th>
            <td><%= @show.venue.name if @show.venue %></td>
        </tr>
		<tr>
			<th>XTS Pro ID</th>
			<td><%= @show.xts_id %></td>
		</tr>
		<tr>
			<th>Public?</th>
			<td><%= {true => "Yes", false => "No", nil => "No"}[@show.is_public] %>
        </tr>
        <tr>
            <th>Image</th>
            <td><%= image_tag @show.image.url(:medium) %></td>
        </tr>
        <tr>
            <th>Team</th>
            <td>
                <% @show.team_members.each do |team_member| %>
                  <p>
                  <b><%= team_member.position %></b>

                  <% u = team_member.user %>
                  <%= "#{u.first_name} #{u.last_name}".presence || u.email %>
                  </p>
                <% end %>
            </td>
        </tr>
	</tbody>
</table>

<% if can? :edit, @show %>
  <%= link_to 'Edit', edit_admin_show_path(@show), class: 'btn'%>
<% end %>

<% questionnaire = Admin::Questionnaires::Questionnaire.where(:show_id => @show.id) %>

<% if questionnaire.count == 0 then %>
  <% if can? :create, Admin::Questionnaires::Questionnaire %>
    <%= link_to 'Create Questionnaire', create_questionnaire_admin_show_path(@show), :method => :put, :class => 'btn'%>
  <% end %>
<% else %>
  <% if can? :read, questionnaire.first %>
    <%= link_to 'View Questionnaire', admin_questionnaires_questionnaire_path(questionnaire.first), :class => 'btn'%>
  <% end %>
<% end %>