<% @title = 'Show Details' %>

<h1><%= @show.name %></h1>
<table class="table table-bordered">
	<tbody>
		<tr>
			<th>Tagline</th>
			<td><%= @show.tagline %></td>
		</tr>
		<tr>
			<th>URL Slug</th>
			<td><%= @show.slug %></td>
		</tr>
		<tr>
			<th>Description</th>
			<td><%= render_markdown @show.description %></td>
		</tr>
        <tr>
            <th>Dates</th>
            <td><%= @show.date_range %></td>
        </tr>
        <tr>
            <th>Venue</th>
            <td><%= @show.venue.name if @show.venue %></td>
        </tr>
		<tr>
			<th>XTS Pro ID</th>
			<td><%= @show.xts_id %></td>
		</tr>
		<tr>
			<th>Public?</th>
			<td><%= {true => "Yes", false => "No", nil => "No"}[@show.is_public] %>
        </tr>
        <tr>
            <th>Image</th>
            <td><%= image_tag @show.image.url(:medium) %></td>
        </tr>
        <tr>
            <th>Team</th>
            <td>
                <% @show.team_members.each do |team_member| %>
                  <p>
                  <b><%= team_member.position %></b>

                  <% u = team_member.user %>
                  <%= "#{u.first_name} #{u.last_name}".presence || u.email %>
                  </p>
                <% end %>
            </td>
        </tr>
	</tbody>
</table>

<% if can? :edit, @show %>
  <%= link_to 'Edit', edit_admin_show_path(@show), class: 'btn', :method => :put %>
<% end %>

<% if @show.users.include? current_user or can?(:read, Admin::Questionnaires::Questionnaire) then %>
  <h3>Questionnaires</h3>

  <table class="table">
    <tbody>
      <% @show.questionnaires.each do |questionnaire| %>
        <tr>
          <td><%= link_to "Answer #{questionnaire.name} Questionnaire", answer_admin_questionnaires_questionnaire_path(questionnaire) %></td>
          <% if can? :edit, questionnaire %>
            <td><%= link_to 'Edit', edit_admin_questionnaires_questionnaire_path(questionnaire) %></td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>

  <% if can? :create, Admin::Questionnaires::Questionnaire then %>
    <%= form_tag add_questionnaire_admin_show_path(@show), :method => :put, :class => "form-inline" do %>
      <%= text_field_tag :questionnaire_name, nil, :placeholder => "Questionnaire Name" %>
      <%= submit_tag 'Add Questionnaire', :class => 'btn' %>
    <% end %>
  <% end %>
<% end %>